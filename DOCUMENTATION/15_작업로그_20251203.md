# 📋 작업 로그 - 2025년 12월 3일

## 📌 작업 개요

| 항목 | 내용 |
|------|------|
| 시작 버전 | v2.2 |
| 종료 버전 | v2.7.1 |
| 주요 작업 | Scope 3 개선, 건물 분석 기능, UI 개선, 탭 가이드 |

---

## ✅ 완료된 작업

### 1. Scope 3 교통 배출계수 개선 (v2.3)

**문제**: Scope 3 교통 배출계수의 공식 출처 미확인

**해결**:
- 3가지 배출계수 기준 옵션 구현
  - ⚠️ 추정치: 대략적 규모 파악용
  - DEFRA 2024: 영국 정부 공식 배출계수
  - 연료 기반: 연비 입력으로 국가 배출계수 활용
- 라디오 버튼 UI로 선택 가능
- 각 기준별 출처 표시

**파일 변경**:
- `data.js`: `DEFRA_EMISSION_FACTORS`, `FUEL_BASED_EMISSION_FACTORS` 추가
- `index.html`: 라디오 버튼 그룹 추가
- `app.js`: `onTransportStandardChange()` 함수 추가

---

### 2. 바이오연료 지원 (v2.4)

**추가된 연료**:
- 목재펠릿, 우드칩, 폐목재
- 바이오가스, 바이오디젤, 바이오에탄올

**파일 변경**:
- `data.js`: `FUEL_DATA`에 바이오연료 추가
- `index.html`: 연료 선택 `optgroup` 추가
- `calculator.js`: 바이오연료 CH4 배출계수 처리

---

### 3. 시계열 라인 차트 (v2.4)

**기능**: 배출량 추가 순서별 누적 트렌드 시각화

**파일 변경**:
- `app.js`: `createLineChart()` 함수 추가

---

### 4. PDF 리포트 생성 (v2.4)

**기능**: 종합 보고서 PDF 다운로드

**포함 내용**:
- 건물 정보
- Scope 1/2/3 상세 내역
- 원단위 분석
- 녹색건축 인증 예측

**파일 변경**:
- `index.html`: jsPDF CDN 추가, PDF 버튼 추가
- `app.js`: `exportToPdf()` 함수 구현

---

### 5. 원단위 분석 및 벤치마크 (v2.5)

**기능**:
- 면적당 배출량 (kgCO2eq/m²·년)
- 인당 배출량 (tCO2eq/인·년)
- 건물 유형별 벤치마크 비교

**건물 유형**: 사무실, 학교, 병원, 호텔, 쇼핑몰, 아파트, 단독주택, 공장, 기타

**파일 변경**:
- `data.js`: `BUILDING_BENCHMARKS` 객체 추가
- `index.html`: 건물 정보 입력, 원단위 표시 영역
- `app.js`: `updateUnitAnalysis()`, `updateBenchmark()` 함수

---

### 6. G-SEED / ZEB 인증 예측 (v2.6)

**G-SEED 녹색건축인증**:
- 배출량 기준 점수 예측 (50~80점)
- 등급: 최우수(80+), 우수(70+), 우량(60+), 일반(50+)

**ZEB 제로에너지빌딩**:
- 신재생에너지 생산량 입력
- 에너지자립률 계산
- 등급: 1등급(100%+) ~ 5등급(20%+)

**파일 변경**:
- `data.js`: `GSEED_CRITERIA`, `ZEB_CRITERIA` 추가
- `index.html`: 인증 예측 UI 섹션
- `app.js`: `updateCertifications()` 함수

---

### 7. 전력 배출계수 연도별 선택 (v2.7)

**발견**: 두 가지 전력 배출계수 시스템 존재
1. ETS 계획기간별 고정값 (3기: 456.7, 4기: 474.7)
2. 연도별 실측값 (2017~2022)

**구현**:
- 드롭다운에서 8가지 옵션 선택 가능
- 출처 자동 표시

**파일 변경**:
- `data.js`: `ELECTRICITY_ETS_DATA`, `ELECTRICITY_YEARLY_DATA` 분리
- `index.html`: 전력 배출계수 기준 드롭다운
- `app.js`: `updateScope2Params()` 수정

---

### 8. Scope 1 단위 통일 (v2.7)

**문제**: 단위 변환 시 계산 오류 가능성

**해결**: 연료별 단일 단위 고정
- 천연가스(LNG): ton
- 도시가스: 천m³
- 석유류: kL
- 석탄류: ton
- 바이오가스: 천m³
- 바이오디젤/에탄올: kL

**파일 변경**:
- `data.js`: 단위 배열을 단일 값으로 변경

---

### 9. 입력 도움말/참고값 (v2.7.1)

**기능**:
- 건물 유형별 에너지 소비 참고값 표시
- Scope별 간략 가이드 (ℹ️ 버튼)
- Scope 2 입력값 유효성 검증 (경고 표시)

**파일 변경**:
- `data.js`: `ENERGY_REFERENCE_VALUES` 추가
- `index.html`: 도움말 버튼, 참고값 패널
- `app.js`: `initHelpSystem()`, `validateScope2Input()` 함수
- `style.css`: `.help-panel`, `.warning-message` 스타일

---

### 10. UI 레이아웃 개선 (v2.7.1)

**변경 사항**:
- 좌측/우측 패널 너비 확대 (200px → 280px / 300px → 380px)
- 헤더 버튼 아이콘+텍스트 조합으로 변경
- 텍스트 줄바꿈 방지 (`white-space: nowrap`)
- 헤더 투명도 조정 (50%)
- 상단 여백 증가 (padding-top: 70px)

**파일 변경**:
- `style.css`: `main-grid`, `header-buttons`, `btn-icon-label` 등

---

### 11. 폰트 변경 (v2.7.1)

**변경**: Nunito 폰트 적용 (wght 300~900)

**타이포그래피 최적화**:
- 레이블: 0.85rem, 600
- 섹션 제목: 0.95rem, 700
- 결과값: 1.3rem, 700
- 총합값: 1.1rem, 700
- 입력 필드: 500
- text-muted/secondary 투명도 조정

---

### 12. 탭 네비게이션 + 내장 가이드 (v2.7.1)

**구현**:
- 헤더에 3개 탭: 🧮 계산기, 📚 완벽 가이드, 📖 사용자 매뉴얼
- 가이드 콘텐츠 HTML로 내장
- 목차 부드러운 스크롤
- 반응형 레이아웃

**파일 변경**:
- `index.html`: 탭 버튼, 가이드/매뉴얼 콘텐츠 추가
- `style.css`: `.main-tabs`, `.guide-*` 스타일
- `app.js`: `initMainTabs()` 함수

---

### 13. 문서 업데이트

**수정된 문서**:
- `10_온실가스_계산기_완벽_가이드.md`: Scope 3, GWP, 전력 배출계수 등 추가
- `11_웹앱_사용자_매뉴얼.md`: 전체 기능 설명 업데이트
- `12_확장기능_로드맵.md`: 완료 항목 체크

---

## 🧪 테스트 수행

### 자동화 테스트
- 100개 이상 시나리오 테스트
- Scope 1/2/3 계산 검증
- 단위 변환, 항목 추가, 내보내기 테스트

### 수동 검증
- 도시가스 175천m³ → 382.25 tCO2eq ✅
- 전기 900MWh (4기) → 430.26 tCO2eq ✅
- 원단위 분석 계산 정확성 ✅
- 벤치마크 비교 로직 ✅

---

## 🐛 수정된 버그

1. **Scope 3 → Scope 2 오류**: Excel 내보내기에서 Scope 3 항목이 Scope 2로 표시되던 문제
2. **통근 왕복 미표시**: 왕복 계산임을 UI에 명시
3. **전력 배출계수 혼동**: ETS와 연도별 실측 분리
4. **단위 변환 오류**: 연료별 단일 단위 고정으로 해결
5. **탭-테마 버튼 겹침**: 헤더 레이아웃 수정

---

## 📊 파일 변경 요약

| 파일 | 변경 유형 | 라인 수 |
|------|----------|--------|
| `index.html` | 대규모 수정 | ~1,672 |
| `style.css` | 대규모 수정 | ~2,303 |
| `app.js` | 대규모 수정 | ~2,400 |
| `data.js` | 중규모 수정 | ~600 |
| `calculator.js` | 소규모 수정 | ~200 |

---

## 📝 다음 작업 예정

1. **추가 연료**: 항공유, 납사, 연탄, 코크스
2. **감축 시뮬레이션**: "만약 ~하면?" 분석
3. **다국어 지원**: 영어, 일본어
4. **반응형 디자인**: 모바일 레이아웃 개선
5. **데스크톱 앱**: Electron 패키징

---

*작성일: 2025-12-03*
*작성자: AI Assistant (Claude)*

