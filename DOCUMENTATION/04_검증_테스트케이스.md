# 검증 테스트 케이스

## 📋 테스트 목적
Excel 계산기와 웹/데스크톱 앱의 계산 결과가 **완벽히 일치**하는지 검증

---

## 🧪 테스트 케이스 1: 기본 설정값 (Excel 기본값)

### 입력값
| 항목 | 값 |
|------|-----|
| 세부 | 주거용 |
| 연간 GHG 배출량 | 1 만ton/yr |
| 시설규모 | A (자동계산) |
| 배출계수 기준년도 | 국가고유(17년) |
| 열량계수 기준년도 | 국가고유(17년) |

### Scope 1 입력
| 항목 | 값 |
|------|-----|
| 연료 | 천연가스(LNG) |
| GHG 종류 | CO2 |
| 연료 상태 | Default (→ 기체) |
| 연료 사용량 | 1 |
| 단위 | ton-연료 |
| 열량계수 Tier | T2 |
| 배출계수 Tier | T2 |
| 산화계수 Tier | T2 (=배출계수 Tier) |

### Scope 1 기대 결과
| 항목 | 값 | 산출 근거 |
|------|-----|----------|
| 열량계수 | 49.4 MJ/kg | T2 국가고유값 |
| 배출계수(CO2) | 56,144 kgCO2/TJ | T2 국가고유값 |
| 배출계수(CH4) | 5 kgCH4/TJ | T2 국가고유값 |
| 배출계수(N2O) | 0.1 kgN2O/TJ | T2 국가고유값 |
| 산화계수 | 0.995 | T2 기체 |
| GWP(CO2) | 1 | - |
| GWP(CH4) | 21 | - |
| GWP(N2O) | 310 | - |

### Scope 1 계산 검증

#### CO2 배출량
```
G20 = 0.000001 × 49.4 × 56144 × 0.995 × 1
    = 0.000001 × 2,759,646.032
    = 2.759646032 tCO2

H20 = 2.759646032 × 1 = 2.759646032 tCO2eq
```
**Excel 결과:** 2.7596460319999996

#### CH4 배출량
```
G21 = 0.000001 × 49.4 × 5 × 1  (산화계수 미적용!)
    = 0.000001 × 247
    = 0.000247 tCH4

H21 = 0.000247 × 21 = 0.005187 tCO2eq
```
**Excel 결과:** G21=0.000247, H21=0.005187

#### N2O 배출량
```
G22 = 0.000001 × 49.4 × 0.1 × 1  (산화계수 미적용!)
    = 0.000001 × 4.94
    = 0.00000494 tN2O

H22 = 0.00000494 × 310 = 0.0015314 tCO2eq
```
**Excel 결과:** G22=4.94e-06, H22=0.0015314

#### Scope 1 총합
```
G25 = H20 + H21 + H22
    = 2.759646032 + 0.005187 + 0.0015314
    = 2.7663644 tCO2eq
```
**Excel 결과:** 2.7663644319999996

---

### Scope 2 입력
| 항목 | 값 |
|------|-----|
| 연료 | 전기(소비단) |
| GHG 종류 | CH4 |
| 사용량 | 1 |
| 단위 | MWh |

### Scope 2 기대 결과
| 항목 | 값 |
|------|-----|
| 전력 배출계수(CH4) | 0.0036 kgCH4/MWh |
| GWP(CH4) | 21 |

### Scope 2 계산 검증
```
D42 = 1 × 0.0036 × 0.001
    = 0.0000036 tCH4

E42 = 0.0000036 × 21 = 0.0000756 tCO2eq
```
**Excel 결과:** D42=3.6e-06, E42=7.56e-05

---

## 🧪 테스트 케이스 2: 경유 + 전기(소비단) CO2

### Scope 1 입력
| 항목 | 값 |
|------|-----|
| 연료 | 경유 (가스/디젤 오일) |
| GHG 종류 | CO2 |
| 연료 상태 | Default (→ 액체) |
| 연료 사용량 | 100 |
| 단위 | kL-연료 |
| 열량계수 Tier | T2 |
| 배출계수 Tier | T2 |

### Scope 1 예상 계산
```
열량계수 = 35.2 MJ/kg (또는 kL당 환산 필요)
배출계수(CO2) = 73,740 kgCO2/TJ
산화계수 = 0.99 (액체, T2)

※ 단위 변환 주의: kL → kg 또는 kL → TJ 변환 필요
```

### Scope 2 입력
| 항목 | 값 |
|------|-----|
| 연료 | 전기(소비단) |
| GHG 종류 | CO2 |
| 사용량 | 1000 |
| 단위 | MWh |

### Scope 2 예상 계산
```
배출계수(CO2) = 456.7 kgCO2/MWh (국가고유 17년)

D42 = 1000 × 456.7 × 0.001 = 456.7 tCO2
E42 = 456.7 × 1 = 456.7 tCO2eq
```

---

## 🧪 테스트 케이스 3: 지역난방 (열)

### Scope 2 입력
| 항목 | 값 |
|------|-----|
| 연료 | 열전용 |
| GHG 종류 | CO2 |
| 사용량 | 1 |
| 단위 | TJ |
| 지역 | 수도권지사 |
| 계획기간 | 4기 |

### 지역난방 배출계수 (4기, 수도권지사)
| 온실가스 | 배출계수 (kgGHG/TJ) |
|----------|---------------------|
| CO2 | 35,991 |
| CH4 | 0.6519 |
| N2O | 0.0661 |

### 예상 계산
```
D42 = 1 × 35991 × 0.001 = 35.991 tCO2
E42 = 35.991 × 1 = 35.991 tCO2eq
```

---

## 🧪 테스트 케이스 4: 시설규모별 Tier 변화

### 시설규모 A (연간 배출량 < 5만ton)
| 항목 | 최소 Tier |
|------|-----------|
| 열량계수 | T2 |
| 배출계수 | T1 |
| 산화계수 | T1 |

### 시설규모 B (5만ton ≤ 연간 배출량 < 50만ton)
| 항목 | 최소 Tier |
|------|-----------|
| 열량계수 | T2 |
| 배출계수 | T2 |
| 산화계수 | T2 |

### 시설규모 C (연간 배출량 ≥ 50만ton)
| 항목 | 최소 Tier |
|------|-----------|
| 열량계수 | T3 |
| 배출계수 | T3 |
| 산화계수 | T3 |

---

## ✅ 검증 체크리스트

### 1. 기본 계산 정확성
- [ ] CO2 배출량 계산 (열량계수 × 배출계수 × 산화계수 × 사용량 × 10⁻⁶)
- [ ] CH4 배출량 계산 (열량계수 × 배출계수 × 사용량 × 10⁻⁶, 산화계수 미적용)
- [ ] N2O 배출량 계산 (열량계수 × 배출계수 × 사용량 × 10⁻⁶, 산화계수 미적용)
- [ ] tCO2eq 변환 (tGHG × GWP)
- [ ] 총 배출량 합산

### 2. 데이터 조회 정확성
- [ ] 연료별 열량계수 T1/T2 조회
- [ ] 연료별 배출계수 T1/T2 조회
- [ ] 연료상태별 산화계수 조회
- [ ] GWP 조회
- [ ] 전력 배출계수 조회 (발전단/소비단, 17년/22년)
- [ ] 열(스팀) 배출계수 조회
- [ ] 지역난방 배출계수 조회 (지역, 계획기간)

### 3. 조건부 로직 정확성
- [ ] 시설규모 자동 판정 (A/B/C)
- [ ] Tier별 데이터 참조 열 선택
- [ ] 연료 상태 자동 조회 (Default인 경우)
- [ ] 전기 vs 열 분기 처리

### 4. 부동소수점 정밀도
- [ ] Excel 결과와 동일한 소수점 이하 자릿수
- [ ] 반올림 오차 허용 범위 정의 (예: ±0.0001)

---

## 📌 주의사항

1. **산화계수 적용 범위**
   - CO2만 산화계수 적용
   - CH4, N2O는 산화계수 미적용

2. **단위 변환**
   - MJ/kg → TJ/ton: ÷ 1,000,000
   - kgGHG → tGHG: ÷ 1,000
   - 0.000001 = 10⁻⁶ 계수에 단위 변환 포함

3. **VLOOKUP 동작**
   - 정확히 일치하는 값 조회 (마지막 인수 = 0)
   - 연료명으로 조회

4. **Excel 부동소수점**
   - JavaScript와 Excel의 부동소수점 계산 차이 고려
   - 최종 결과 비교 시 허용 오차 설정

